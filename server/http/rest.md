# 理解 RESTful 架构

http://www.ruanyifeng.com/blog/2011/09/restful




# RESTful Web 服务四种操作 POST/DELETE/PUT/GET

来源：http://www.python88.com/topic/132/

表征状态转移（Representational State Transfer，简称REST）是 Roy Fielding 在2000年他的博士论文中提出来的一种软件架构风格。

目前在三种主流的Web服务实现方案中，因为REST模式的Web服务与复杂的SOAP和XML-RPC对比来讲明显的更加简洁，越来越多的web服务开始采用REST风格设计和实现。

## Rest模式有四种操作

* POST /uri 创建 
* DELETE /uri/xxx 删除 
* PUT /uri/xxx 更新或创建 
* GET /uri/xxx 查看 

GET 操作是安全的。所谓安全是指不管进行多少次操作，资源的状态都不会改变。比如我用 GET 浏览文章，不管浏览多少次，那篇文章还在那，没有变化。当然，你可能说每浏览一次文章，文章的浏览数就加一，这不也改变了资源的状态么？这并不矛盾，因为这个改变不是 GET 操作引起的，而是用户自己设定的服务端逻辑造成的。

PUT，DELETE 操作是幂等的。所谓幂等是指不管进行多少次操作，结果都一样。比如我用 PUT 修改一篇文章，然后再做同样的操作，每次操作后的结果并没有不同，DELETE 也是一样。顺便说一句，因为 GET 操作是安全的，所以它自然也是幂等的。

POST 操作既不是安全的，也不是幂等的，比如常见的 POST 重复加载问题：当我们多次发出同样的 POST 请求后，其结果是创建出了若干的资源。

安全和幂等的意义在于：当操作没有达到预期的目标时，我们可以不停的重试，而不会对资源产生副作用。从这个意义上说，POST 操作往往是有害的，但很多时候我们还是不得不使用它。

还有一点需要注意的就是，创建操作可以使用 POST，也可以使用 PUT，区别在于 POST 是作用在一个集合资源之上的（/uri），而 PUT 操作是作用在一个具体资源之上的（/uri/xxx），再通俗点说，如果 URL 可以在客户端确定，那么就使用 PUT，如果是在服务端确定，那么就使用 POST，比如说很多资源使用数据库自增主键作为标识信息，而创建的资源的标识信息到底是什么只能由服务端提供，这个时候就必须使用 POST。

## 关于GET POST 的混淆

先说相同点，只有了解了相同点之后才能理解为什么会发生混淆。两者都能向服务器发送数据，提交的“内容”[注1]的格式相同，都是 var_1=value_1&var_2=value_2&.... get 和 post 区别如字面，一个是get（获取），一个是post（发送）。get用来告诉服务器需要获取哪些内容（uri+query），向静态页面（uri）请求则直接返回文件内容给浏览器，向一个动态页面请求时可以提供查询参数（query）以获得相应内容。post用来向服务器提交内容，主要是为了提交，而不是为了请求内容，就是说post的初衷并不要求服务器返回内容[注2]，只是提交内容让服务器处理（主要是存储或者处理之后再存储）。get和post出现混淆是因为对提交的数据处理方法的滥用造成的，数据是无辜的。

混淆之一：
将 get 提交的用来查询的字段当作是存储数据存入了服务器端文件或者数据库。然后就误以为 get 是用来提交用于存储的数据的。

混淆之二：
编写脚本在服务器端通过处理 post 提交的数据并返回内容。只要有数据，就能用来进行判断，脚本怎写是程序员的事，而不在乎数据来源的形式（post、g
et，或者是自己预设值的常量）。这点功能上确实没问题，只是背离的其初始目的而已。

由于都是要传送数据，且数据格式相同（即使数据格式不同，只要能提取出相应数据）。使用的时候难免出现张冠李戴，将 get 数据用来存储、将 post 数据用来检索返回数据。但是二者还是有区别的（主要是根据其用途而“人为”[注3]造成的），get 的长度限制在 2048字节（由浏览器和服务器限制的，这是目前IE的数据，曾经是1024字节），很大程度上限制了 get 用来传递“存储数据”的数据的能力，所以还是老老实实用来做检索吧；post 则无此限制（只是 HTTP 协议规范没有进行大小限制，
但受限于服务器的处理能力），因此对于大的数据（一般来说需要存储的数据可能会比较大，比2048字节大）的传递有天然的优势，谁让它是 nature born post 呢。

get 提交的数据是放在 url 里，目的是灵活的向服务器提交检索请求，可以在地址栏随时修改数据以变更需要获取的内容，比如直接修改分页的编号就跳到另外一个分页了（当然也可能是404）。post 提交的数据放在 http 请求的正文里，目的在于提交数据并用于服务器端的存储，而不允许用户过多的更改相应数据（主要是相对于在 url 修改要麻烦很多，url 的修改只要点击地址栏输入字符就可以了），除非是专门跑来编辑数据的。

花边：post 和 get 的安全性在传输的层面上区别不大，但是采用 url 提交数据的 get 方式容易被人肉眼看到，或者出现在历史纪录里，还是可能被肉眼看到，都是一些本地的问题。

* 注1：我强调的是内容，至于http协议中的get和post的格式大家有兴趣就自己看看吧。 
* 注2：get 方式主要是为了获得预期内容，即 uri+query 相同时所得到的内容应该是相同的。而 post 主要是提交内容，至于是否有必要返回页面可能只是出于用户体验，比如注册时返回你的注册id，但是如果只是返回一个“您已注册成功”的相同页面（即使你 post 的数据不一样）也没什么好奇怪的。 
* 注3：关于这个“人为”，不是那么贴切，get和post还是有技术层面的区别的。但是从表象上看暂且这么说吧，毕竟二者的混淆也是“人为”的。
