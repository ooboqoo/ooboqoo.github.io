<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="../w3c.css" />
<script src="../notes.js"></script>
<title>JSON</title>
</head>
<body>
<div id="article">

<h1>JSON 教程</h1>

<div id="intro">
<p><strong>JSON：JavaScript 对象表示法（<span class="marked">J</span>ava<span class="marked">S</span>cript <span class="marked">O</span>bject <span class="marked">N</span>otation）。</strong></p>
<p><strong>JSON 是存储和交换文本信息的语法。类似 XML。</strong></p>
<p><strong>JSON 比 XML 更小、更快，更易解析。</strong></p>
</div>

<div>
<h2>每一章中用到的实例</h2>

<pre>{
"employees": [
{ "firstName":"Bill" , "lastName":"Gates" },
{ "firstName":"George" , "lastName":"Bush" },
{ "firstName":"Thomas" , "lastName":"Carter" }
]
}
</pre>

<p>这个 employee 对象是包含 3 个员工记录（对象）的数组。</p>
</div>


<div>
<h2>什么是 JSON ？</h2>

<ul>
<li>JSON 指的是 JavaScript 对象表示法（<em>J</em>ava<em>S</em>cript <em>O</em>bject <em>N</em>otation）</li>
<li>JSON 是轻量级的文本数据交换格式</li>
<li>JSON 独立于语言 <span class="marked">*</span></li>
<li>JSON 具有自我描述性，更易理解</li>
</ul>

<p><span class="marked">*</span> JSON 使用 JavaScript 语法来描述数据对象，但是 JSON 仍然独立于语言和平台。JSON 解析器和 JSON 库支持许多不同的编程语言。</p>
</div>


<div>
<h2>JSON - 转换为 JavaScript 对象</h2>

<p>JSON 文本格式在语法上与创建 JavaScript 对象的代码相同。</p>

<p>由于这种相似性，无需解析器，JavaScript 程序能够使用内建的 <a href="/jsref/jsref_eval.asp" title="JavaScript eval() 函数">eval() 函数</a>，用 JSON 数据来生成原生的 JavaScript 对象。</p>
</div>

<h1>JSON 简介</h1>

<div>
<h2>亲自试一试 - 实例</h2>

<p>通过我们的编辑器，您可以在线编辑 JavaScript 代码，然后通过点击一个按钮来查看结果：</p>

<pre>&lt;html&gt;
&lt;body&gt;
&lt;h2&gt;在 JavaScript 中创建 JSON 对象&lt;/h2&gt;

&lt;p&gt;
Name: &lt;span id="jname"&gt;&lt;/span&gt;&lt;br /&gt;
Age: &lt;span id="jage"&gt;&lt;/span&gt;&lt;br /&gt;
Address: &lt;span id="jstreet"&gt;&lt;/span&gt;&lt;br /&gt;
Phone: &lt;span id="jphone"&gt;&lt;/span&gt;&lt;br /&gt;
&lt;/p&gt;

&lt;script type="text/javascript"&gt;
<code>var JSONObject= {
"name":"Bill Gates",
"street":"Fifth Avenue New York 666",
"age":56,
"phone":"555 1234567"};</code>
document.getElementById("jname").innerHTML=<span class="marked">JSONObject.name</span>
document.getElementById("jage").innerHTML=<span class="marked">JSONObject.age</span>
document.getElementById("jstreet").innerHTML=<span class="marked">JSONObject.street</span>
document.getElementById("jphone").innerHTML=<span class="marked">JSONObject.phone</span>
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>

<p class="tiy"><a target="_blank" href="/tiy/t.asp?f=json_create">亲自试一试</a></p>
</div>


<div>
<h2>类似 XML</h2>

<ul>
<li>JSON 是纯文本</li>
<li>JSON 具有“自我描述性”（人类可读）</li>
<li>JSON 具有层级结构（值中存在值）</li>
<li>JSON 可通过 JavaScript 进行解析</li>
<li>JSON 数据可使用 AJAX 进行传输</li>
</ul>
</div>


<div>
<h2>相比 XML 的不同之处</h2>

<ul>
<li>没有结束标签</li>
<li>更短</li>
<li>读写的速度更快</li>
<li>能够使用内建的 JavaScript eval() 方法进行解析</li>
<li>使用数组</li>
<li>不使用保留字</li>
</ul>
</div>


<div>
<h2>为什么使用 JSON？</h2>

<p>对于 AJAX 应用程序来说，JSON 比 XML 更快更易使用：</p>

<h4>使用 XML</h4>

<ul>
<li>读取 XML 文档</li>
<li>使用 XML DOM 来循环遍历文档</li>
<li>读取值并存储在变量中</li>
</ul>

<h4>使用 JSON</h4>

<ul>
<li>读取 JSON 字符串</li>
<li>用 eval() 处理 JSON 字符串</li>
</ul>
</div>

<h1>JSON 语法</h1>

<div id="intro">
<p><strong>JSON 语法是 JavaScript 语法的子集。</strong></p>
</div>


<div>
<h2>JSON 语法规则</h2>

<p>JSON 语法是 JavaScript 对象表示法语法的子集。</p>

<ul>
<li>数据在名称/值对中</li>
<li>数据由逗号分隔</li>
<li>花括号保存对象</li>
<li>方括号保存数组</li>
</ul>
</div>


<div>
<h2>JSON 名称/值对</h2>

<p>JSON 数据的书写格式是：名称/值对。</p>

<p>名称/值对包括字段名称（在双引号中），后面写一个冒号，然后是值：</p>

<pre>"firstName" : "John"</pre>

<p>这很容易理解，等价于这条 JavaScript 语句：</p>

<pre>firstName = "John"</pre>
</div>


<div>
<h2>JSON 值</h2>

<p>JSON 值可以是：</p>

<ul>
<li>数字（整数或浮点数）</li>
<li>字符串（在双引号中）</li>
<li>逻辑值（true 或 false）</li>
<li>数组（在方括号中）</li>
<li>对象（在花括号中）</li>
<li>null</li>
</ul>
</div>


<div>
<h2>JSON 对象</h2>

<p>JSON 对象在花括号中书写：</p>

<p>对象可以包含多个名称/值对：</p>

<pre>{ "firstName":"John" , "lastName":"Doe" }</pre>

<p>这一点也容易理解，与这条 JavaScript 语句等价：</p>

<pre>firstName = "John"
lastName = "Doe"
</pre>
</div>


<div>
<h2>JSON 数组</h2>

<p>JSON 数组在方括号中书写：</p>

<p>数组可包含多个对象：</p>

<pre>{
"employees": [
{ "firstName":"John" , "lastName":"Doe" },
{ "firstName":"Anna" , "lastName":"Smith" },
{ "firstName":"Peter" , "lastName":"Jones" }
]
}
</pre>

<p>在上面的例子中，对象 "employees" 是包含三个对象的数组。每个对象代表一条关于某人（有姓和名）的记录。</p>
</div>


<div>
<h2>JSON 使用 JavaScript 语法</h2>

<p>因为 JSON 使用 JavaScript 语法，所以无需额外的软件就能处理 JavaScript 中的 JSON。</p>

<p>通过 JavaScript，您可以创建一个对象数组，并像这样进行赋值：</p>

<h3>例子</h3>

<pre>var employees = [
{ "firstName":"Bill" , "lastName":"Gates" },
{ "firstName":"George" , "lastName":"Bush" },
{ "firstName":"Thomas" , "lastName": "Carter" }
];
</pre>

<p>可以像这样访问 JavaScript 对象数组中的第一项：</p>

<pre>employees[0].lastName;</pre>

<p>返回的内容是：</p>

<pre>Gates</pre>

<p>可以像这样修改数据：</p>

<pre>employees[0].lastName = "Jobs";</pre>

<p class="tiy"><a target="_blank" href="/tiy/t.asp?f=json_objectarray">亲自试一试</a></p>

<p>在下面的章节，您将学到如何把 JSON 文本转换为 JavaScript 对象。</p>
</div>


<div>
<h2>JSON 文件</h2>

<ul>
<li>JSON 文件的文件类型是 ".json"</li>
<li>JSON 文本的 MIME 类型是 "application/json"</li>
</ul>
</div>

<h1>JSON 使用</h1>

<div>
<h2>把 JSON 文本转换为 JavaScript 对象</h2>

<p>JSON 最常见的用法之一，是从 web 服务器上读取 JSON 数据（作为文件或作为 HttpRequest），将 JSON 数据转换为 JavaScript 对象，然后在网页中使用该数据。</p>

<p>为了更简单地为您讲解，我们使用字符串作为输入进行演示（而不是文件）。</p>
</div>


<div>
<h2>JSON 实例 - 来自字符串的对象</h2>

<p>创建包含 JSON 语法的 JavaScript 字符串：</p>

<pre>var txt = '{ "employees" : [' +
'{ "firstName":"Bill" , "lastName":"Gates" },' +
'{ "firstName":"George" , "lastName":"Bush" },' +
'{ "firstName":"Thomas" , "lastName":"Carter" } ]}';
</pre>

<p>由于 JSON 语法是 JavaScript 语法的子集，JavaScript 函数 eval() 可用于将 JSON 文本转换为 JavaScript 对象。</p>

<p>eval() 函数使用的是 JavaScript 编译器，可解析 JSON 文本，然后生成 JavaScript 对象。必须把文本包围在括号中，这样才能避免语法错误：</p>

<pre>var obj = eval ("(" + txt + ")");</pre>

<p>在网页中使用 JavaScript 对象：</p>

<h3>例子</h3>

<pre>&lt;p&gt;
First Name: &lt;span id="fname"&gt;&lt;/span&gt;&lt;br /&gt;
Last Name: &lt;span id="lname"&gt;&lt;/span&gt;&lt;br /&gt;
&lt;/p&gt;

&lt;script type="text/javascript"&gt;
document.getElementById("fname").innerHTML = obj.employees[1].firstName
document.getElementById("lname").innerHTML = obj.employees[1].lastName
&lt;/script&gt;
</pre>

<p class="tiy"><a target="_blank" href="/tiy/t.asp?f=json_eval">亲自试一试</a></p>
</div>


<div>
<h2>JSON 解析器</h2>

<p class="tip"><span>提示：</span>eval() 函数可编译并执行任何 JavaScript 代码。这隐藏了一个潜在的安全问题。</p>

<p>使用 JSON 解析器将 JSON 转换为 JavaScript 对象是更安全的做法。JSON 解析器只能识别 JSON 文本，而不会编译脚本。</p>

<p>在浏览器中，这提供了原生的 JSON 支持，而且 JSON 解析器的速度更快。</p>

<p>较新的浏览器和最新的 ECMAScript (JavaScript) 标准中均包含了原生的对 JSON 的支持。</p>

<table class="dataintable">
<tbody><tr>
<th style="width:50%; text-align:center;">Web 浏览器支持</th>
<th style="width:50%; text-align:center;">Web 软件支持</th>
</tr>

<tr>
<td>
	<ul class="listintable" style="margin-left:50px;">
	<li>Firefox (Mozilla) 3.5</li>
	<li>Internet Explorer 8</li>
	<li>Chrome</li>
	<li>Opera 10</li>
	<li>Safari 4</li>
	</ul>
</td>

<td>
	<ul class="listintable" style="margin-left:50px;">
	<li>jQuery</li>
	<li>Yahoo UI</li>
	<li>Prototype</li>
	<li>Dojo</li>
	<li>ECMAScript 1.5</li>
	</ul>
</td>
</tr>
</tbody></table>

<pre>
&lt;p id="demo"&gt;&lt;/p&gt;
&lt;script&gt;
  var text = '{"name":"John Johnson","street":"Oslo West 16","phone":"555 1234567"}';
  <code>var obj = JSON.parse(text);</code>
  document.getElementById("demo").innerHTML =
  obj.name + "&lt;br&gt;" +
  obj.street + "&lt;br&gt;" +
  obj.phone;
&lt;/script&gt;
</pre>
<p>Older browsers without the support for the JavaScript function JSON.parse() can use the eval() function to convert a JSON text into a JavaScript object:</p>
<pre>var obj = eval ("(" + text + ")");</pre>
</div>

</div>
</body>
</html>