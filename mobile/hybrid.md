# 混合式开发实战

## 为什么需要混合式开发

### 混合式开发种类

#### WebView 模式

WebView 模式的代表是 PhoneGap 和 Cordova，App 原生部分仅仅作为一个容器，主要的业务代码都通过 HTML CSS JS 放置在 WebView 中执行。

#### JavaScriptCore 模式

除了传统的基于 WebView 的混合应用，JavaScriptCore 带来了一种全新的开发模式，即通过 JavaScript 调用原生代码渲染原生控件的混合式开发。

JavaScriptCore 框架原来只提供在 WebView 的 Webkit 内核中，在 iOS7 中开放了这一能力，之后再 Android 中也提供了类似的功能，从而催生了 React Native 这样使用 JavaScript 作为 Bridge 操作原生代码来构建应用的方案，构建出的整个应用可以被理解为原生应用。

#### 微信小程序

微信小程序本质仍使用了 WebView 方案，但独立设计了一套语法对应传统的 HTML CSS JS，限制了一些可能导致问题的语法，在部分组件上也学习了 React Native 类框架直接渲染原生组件提升性能，再利用离线缓存获得流畅体验。这种方案依赖应用的内部设计，并非一个通用的解决方案。

### 混合式开发的优势

混合式开发存在着几个显著的优势让其能够被各大厂商迅速接受，主要的优点有以下三个。
  * 跨平台 - 各平台都使用 HTML+CSS+JS 开发，入门门槛低，能有效减少开发人力成本
  * 快速发布 - Web 代码无须编译，目前也是各大主流平台允许的热更新方案，所以对于应用来说，一些活动或者经常发生功能或UI变动的页面是采用混合式开发的合理场景
  * 功能提升 - 如果说只需要前两个优点，WebView 加载页面就能够很好的处理，然而混合式开发还需要原生端的支持。一方面 Web 端在 API 能力上又限制，无法充分利用原生端的资源，而混合式开发可以将这些能力暴露给 Web 端调用。混合式开发的意义同样也在于获得原生端的优势，让用户能够拥有更好的体验。

### 选择合适的混合式开发方案

选择一个合适的方案需要综合三点：开发效率、用户体验和项目复杂度。

如果开发者已经有了现成的应用并且有一定的原生代码开发能力，只是需要让 Web 页面嵌入 APP 中实现一些动态展示，可以选择自行实现一套 WebView 扩展方案。这种方案**轻量**且对现有应用影响很小。

如果内嵌 H5 页面比较复杂或者是需要构建一个完整的 APP，且开发者更专长于 Web 技术，适合 PhoneGap 或 Cordova 这类的方案。其中 Cordova 提供了强大的插件系统，开发者可以在不熟悉原生代码的前提下快速获得原生应用的能力。需要注意的是，在某些场景下(如动画)，WebView 的表现并不流畅，通过这种方案构建的完整应用**体验较差**。

另一方面，开发者需要注意到 WebView 在 Android 系统中存在碎片化，即会出现机型表现差异性，可以引入 Crosswalk 插件替代来保证功能或样子的一致性。在 iOS 也可以引入 WKWebView 来提升整体的性能、稳定性和丰富功能。不过，引入一个新的 WebView 会增大自身 APP 的体积，需要开发者权衡利弊。

对于 React Native 或 Weex 这类技术，既可以实现完整的应用也可以嵌入 APP 作为其中的一部分。这类技术能够提供接近原生应用的体验，但是也存在一些问题，主要体现在：一方面会存在一些平台兼容问题，另一方面 JS 和原生代码设计到多线程的异步通信模型，造成部分效率损耗，另外，因为整个运行过程对原生代码依赖较重，出现问题较难排查。此类技术是目前混合式开发的主流前进方向，开发者应当在保持一定技术敏感的前提下，学习并视情况使用。


## Cordova 开发入门



## React Native 实战








