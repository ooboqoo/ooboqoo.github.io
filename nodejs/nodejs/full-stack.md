# Node.js 与大前端

https://mp.weixin.qq.com/s/qFqxzOsg6Td0r-Y7ZgW5lQ

Node.js 在大前端布局里意义重大，除了基本构建和 Web 服务外，这里我还想讲两点。

首先它打破了原有的前端边界，之前应用开发只分前端和 API 开发。但通过引入 Node.js 做 BFF(Backend for Frontend) 这样的 API proxy 中间层，使得 API 开发也成了前端的工作范围，让后端同学专注于开发 RPC 服务，很明显这样明确的分工是极好的。

其次，在前端开发过程中，有很多问题必须依赖服务器端，比如场景的性能优化，在使用 React 后，导致 bundle 过大，首屏渲染时间过长，而且存在 SEO 问题，这时候使用 Node.js 做 SSR 就是非常好的。

当然，前端开发 Node.js 还是存在一些成本，要了解运维等，会略微复杂一些。不过也有解决方案，比如 Serverless 就可以降级运维成本。在已有 Node.js 拓展的边界内，降级运维成本，提高开发的灵活性，这一定会是一个大趋势。


## 19年 Node.js 趋势解读

首先介绍一下 API 演进与 GraphQL，然后讲一下 SSR 如何结合 API 落地，构建出具有 Node.js 特色的服务，然后再简要介绍下 Node.js 的新特性，最后聊聊我对 Deno 的一点看法。

### API 演进与 GraphQL

书本上的软件工程在互联网高速发展的今天已经不那么适用了，尤其是移动开发火起来之后，所有企业都崇尚*敏捷开发*，快鱼吃慢鱼，甚至觉得2周发一个迭代版本都慢，后面组件化和热更新就是这样产生的。我们对传统的软件工程势必要重新思考，如何提高开发和产品迭代效率成为重中之重。

传统软件开发过程中，需求提出后，先要设计出 UI/UE，然后后端写接口，再然后前端才开始开发，所以串行的流程效率极低。

于是就有了 mock api 的概念。通过静态 API 模拟，使得需求和 UE 出来之后，就能确定静态 API，造一些模拟数据，这样前后端就可以同时开发了。这曾经是提效的非常简单直接的方式。

静态 API 实现有很多种方式，比如简单的基于 Express/Koa 这样的成熟框架，也可以采用专门的静态 API 框架，比如著名的 typicode/json-server，只需要编辑 db.json，放入数据即可。还有更好的解决方案如 YApi，它是一个可本地部署的、打通前后端及 QA 的、可视化的接口管理平台。

通过社区，我们可以了解到当下主流的 API 演进过程。
  1. GitHub v3 的 restful api，经典 rest
  2. 微博 API，非常传统的 json 约定方式
  3. GitHub v4 版本里使用 GraphQL 来构建 API，这也是个趋势

GraphQL 目前看起来比较火，那 GitHub 使用 GraphQL 到底解决的是什么问题呢？

GraphQL 既是一种用于 API 的查询语言也是一个满足你数据查询的运行时。

首先定义一个模型，然后请求你想要的数据，最后返回结果。很明显，这和静态 API 模拟是一样的流程。但 GraphQL 要更强大一些，它可以将这些模型和定义好的 API 和后端很好的集成。于是 GraphQL 就统一了静态 API 模拟和和后端集成。开发者要做的，只是约定模型和 API 查询方法。前后端开发者都遵守一样的模型开发约定，这样就可以简化沟通过程，让开发更高效。

有了 GraphQL 之后，直接在 GraphQL 上编写模型，通过 GraphQL 提供静态 API，省去了之前开发者自己模拟 API 的问题。有了 GraphQL 模型和查询，使用 GraphQL 提供的后端集成方式，后端集成更简单，于是 GraphQL 成了前后端解耦的桥梁。

集成使用的就是基于 Apollo 团队的 GraphQL 全栈解决方案，从后端到前端提供了对应的 lib ，使得前后端开发者使用 GraphQL 更加的方便。


### SSR


### Serverless


